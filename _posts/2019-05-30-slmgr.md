---
layout: post
title: "คำสั่ง slmgr บน Windows"
date: 2019-05-30 12:41:05 +0700
description: พอดีช่วงนี้มีงานที่เกี่ยวข้องกับการจัดการ license ของ Microsoft Windows ให้ต้องจัดการ ก็ว่าได้จังหวะพอดีที่จะเขียนเรื่องใหม่ งั้นเอาเป็นคำสั่ง slmgr ล่ะกัน มาดูว่าจะทำอะไรได้บ้างด้วยคำสั่งนี้ครับ
tags:
- Windows
comments: true
---
สำหรับคำสั่ง slmgr ซึ่งจริงๆ แล้วก็คือ slmgr.vbs ตัวนี้ก็คือ Windows Licensing Manager - ชื่อก็บอกสรรพคุณอยู่แล้ว สำหรับรายละเอียดลองเข้าไปดูที่นี่: [https://ss64.com/nt/slmgr.html](https://ss64.com/nt/slmgr.html) (ถึงจะอ้างจาก Windows7/2008 แต่ก็ยังได้เนื้อหาที่ครบถ้วนอยู่นะครับ)

สำหรับการจะใช้งาน slmgr - ขั้นแรกคือต้องเปิด Command Prompt ในแบบ `Run as Administrator` ขึ้นมาก่อนจากนั้นก็เรียกใช้งานได้เลย วันนี้เราจะเรียกอะไรบ้าง?

- `slmgr.vbs /dli` : ดูข้อมูลของ license ที่ลงไว้ - เป็นแบบย่อ
- `slmgr.vbs /dlv` : ดูข้อมูลของ license ที่ลงไว้ - เป็นแบบเต็ม
- `slmgr.vbs /ipk #####-#####-#####-#####-#####` : เอาไว้เปลี่ยน license ใหม่ให้เป็นตามคีย์นี้

*เอาล่ะ* - จริงๆ งานในวันนี้หลักๆ ก็มีอยู่แค่นี้ล่ะครับ คือเข้ามาเพื่อจะเปลี่ยน license ให้ถูกต้อง แต่ตรงนี้เรามาเพิ่มเติมกันอีกนิดดีกว่า ว่างๆ ได้กลับมาอ่านเผื่อเอาไว้ใช้

- `slmgr.vbs /xpr` : อันนี้เอาไว้เช็ควันหมดอายุของ license ในกรณีที่ยังไม่ได้ทำการ activate license
- `slmgr.vbs /upk` : อันนี้สำหรับการเอา license ออก แล้วกลับไปเป็น trial หรือไม่ก็คือไม่มี license - จะใช้ก็ตอนย้ายเครื่องแล้ว license ก็เป็นแบบที่บอกว่าให้ย้าย license ไปใช้บนเครื่องอื่นได้ เราก็จะเอา license ออกมาจากเครื่องด้วยคำสั่งนี้
- `slmgr.vbs /cpky` : อันนี้ใช้ตามจากคำสั่งข้างบนคือ `/upk` เอา license ออก - ส่วน `/cpky` คือจะเอา license ออกจาก Registry ด้วย

สำหรับการ Activate Windows

- `slmgr.vbs /ato` : อันนี้สำหรับการ Activate ในแบบ Online
- `slmgr.vbs /dti` : ส่วนอันนี้สำหรับการ Activate ในแบบ Offline - คือเราจะได้ Installation ID มาจากตรงนี้ แล้วก็โทรไปบอกเลขนี้กับ Microsoft แล้วก็ใช้คำสั่งข้างล่างนี้
- `slmgr.vbs /atp Confirmation_ID` : สำหรับ Confirmation_ID ก็คือเลขที่จะได้กลับมาทางโทรศัพท์ เอามาใส่ตรงนี้ก็จบ

*อีกนิดก่อนจบจริงๆ* - สำหรับใครที่ใช้ trail อยู่แล้วสามารถเลื่อนหรือต่อวันหมดอายุออกไปได้ (แต่ก็ไม่ได้ต่อไปได้เรื่อยๆ หรืออันนี้บาง Windows เค้าอาจไม่มีให้เลื่อนแล้ว ต้องลองดูครับ)

- `slmgr.vbs /rearm` : ใช้คำสั่งนี้ครับ สำหรับการเลื่อน/ต่ออายุ trail ออกไป
